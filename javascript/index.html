<!DOCTYPE html>
<html lang="en">

<head>
    <title>Exemplo de requisição HTTP POST com javascript puro para quick server</title>
</head>

<body>
    <h3>Exemplo quick sendo chamado por javascript</h3>
    <input type="text" id="url" style="width:400px;font-size: 16px;height: 30px;border-color: blueviolet;" 
    value="http://localhost:8080/v1/user">
    <br/>
    <br/>
    <input type="text" id="jsonText" name="jsonText"
    style="width:400px;font-size: 16px;height: 30px;border-color: blueviolet;" 
    value='{ "name": "jeffotoni@email.com", "year": 1990}'>
    <br/>
    <br/>
    <button onclick="sendJson();" style="font-size: 16px;width:408px;height: 35px;border-color: blueviolet;">Enviar Json</button>
    <hr />
    <div id="resposta">Mensagem irá aparecer aqui...</div>

    <script>
        function sendJson() {
            console.log("xxxxxxxxxxxxxxxxxxxxxxxxx")
            var field = document.getElementById("jsonText");
            var jsonText = field.value;
            
            var url = document.getElementById('url').value;
            // console.log("url:"+url);
            // alert(url);
            
            var xhttp = new XMLHttpRequest();
            xhttp.open("POST", url);
            xhttp.setRequestHeader('Content-type', 'application/json');
            //xhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
            //xhttp.send(JSON.stringify(JSON.parse(jsonText)));

            const json = {
              name: 'jeff.evi@gmail.com',
              year: 1987,
            }

            xhttp.send(JSON.stringify(json));

            xhttp.onreadystatechange = function () {
                
                console.log(xhttp.status);

            if (xhttp.readyState === 4) {
                console.log(xhttp.status);
                console.log(xhttp.responseText);
                document.getElementById("resposta").innerHTML = xhttp.responseText;
            }};

            console.log("DONE");
        }
    </script>
</body>
</html>